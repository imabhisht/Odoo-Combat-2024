const crimeData = [
	{
		id: "4bbaa042-2042-4ef8-b62e-9e2c5d1f95c1",
		user_id: null,
		type: "theft",
		description: "My laptop was stolen from my car",
		event_time: "2024-06-29T09:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T09:20:30.000Z",
		updated_at: "2024-06-29T09:20:30.000Z",
		title: "Car Laptop Theft",
		lat: "23.206789123",
		long: "72.638912345",
	},
	{
		id: "e3e6cabb-5f4e-4fbf-942d-2febf9c4d7a4",
		user_id: "567fa17e00143f700eb3",
		type: "assault",
		description: "I was attacked in the park",
		event_time: "2024-06-29T09:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T09:35:15.000Z",
		updated_at: "2024-06-29T09:35:15.000Z",
		title: "Park Assault",
		lat: "23.212345678",
		long: "72.630987654",
	},
	{
		id: "aa1db953-4c76-42ea-8d5e-7f5b7e2d3e12",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the subway walls",
		event_time: "2024-06-29T09:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T09:50:30.000Z",
		updated_at: "2024-06-29T09:50:30.000Z",
		title: "Subway Vandalism",
		lat: "23.204567890",
		long: "72.640567890",
	},
	{
		id: "b5f4a9c2-89a8-42c3-b8d8-5eaeb1d1c0e7",
		user_id: "667fa17e00143f700eb4",
		type: "theft",
		description: "My wallet was pickpocketed",
		event_time: "2024-06-29T10:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T10:05:45.000Z",
		updated_at: "2024-06-29T10:05:45.000Z",
		title: "Pickpocketing Incident",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "f1e1c7a6-6c2e-41e1-b4f6-246cda0c4a99",
		user_id: null,
		type: "robbery",
		description: "I was robbed in front of the bank",
		event_time: "2024-06-29T10:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T10:20:30.000Z",
		updated_at: "2024-06-29T10:20:30.000Z",
		title: "Bank Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "c7bb2d9f-0f59-496e-9d27-8eb7ecb367b1",
		user_id: "467fa17e00143f700eb5",
		type: "assault",
		description: "I was assaulted at the nightclub",
		event_time: "2024-06-29T10:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T10:35:15.000Z",
		updated_at: "2024-06-29T10:35:15.000Z",
		title: "Nightclub Assault",
		lat: "23.211234567",
		long: "72.632345678",
	},
	{
		id: "d9c6b3a9-3ea0-48b7-b481-304e4c3fb6e4",
		user_id: null,
		type: "vandalism",
		description: "My mailbox was vandalized",
		event_time: "2024-06-29T10:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T10:50:30.000Z",
		updated_at: "2024-06-29T10:50:30.000Z",
		title: "Mailbox Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "e8f2a1cd-6858-4c91-9a4a-9b3033a6b31f",
		user_id: "567fa17e00143f700eb6",
		type: "theft",
		description: "My purse was stolen from the restaurant",
		event_time: "2024-06-29T11:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T11:05:45.000Z",
		updated_at: "2024-06-29T11:05:45.000Z",
		title: "Restaurant Theft",
		lat: "23.208901234",
		long: "72.638123456",
	},
	{
		id: "a5b9c8d7-3e2a-4f84-9b0f-ade80eabb1b7",
		user_id: null,
		type: "robbery",
		description: "I was mugged while walking in the park",
		event_time: "2024-06-29T11:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T11:20:30.000Z",
		updated_at: "2024-06-29T11:20:30.000Z",
		title: "Park Mugging",
		lat: "23.212345678",
		long: "72.630123456",
	},
	{
		id: "f8a7b6c5-4d3e-47f9-94f5-6e2d5c4e3d2c",
		user_id: "667fa17e00143f700eb7",
		type: "vandalism",
		description: "Graffiti on the school walls",
		event_time: "2024-06-29T11:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T11:35:15.000Z",
		updated_at: "2024-06-29T11:35:15.000Z",
		title: "School Vandalism",
		lat: "23.203456789",
		long: "72.642345678",
	},
	{
		id: "b4c5d6e7-8f9a-4b2c-9d3e-1a0b4c2d3e4f",
		user_id: null,
		type: "theft",
		description: "My watch was stolen at the gym",
		event_time: "2024-06-29T11:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T11:50:30.000Z",
		updated_at: "2024-06-29T11:50:30.000Z",
		title: "Gym Theft",
		lat: "23.205678901",
		long: "72.639678901",
	},
	{
		id: "a3b2c1d0-e9f8-4c7b-8a6d-5b4a3c2d1e0f",
		user_id: "467fa17e00143f700eb8",
		type: "assault",
		description: "I was assaulted at the shopping mall",
		event_time: "2024-06-29T12:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T12:05:45.000Z",
		updated_at: "2024-06-29T12:05:45.000Z",
		title: "Mall Assault",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "f0e1d2c3-b4a5-4e6f-8d7c-9b8a7f6e5d4c",
		user_id: null,
		type: "robbery",
		description: "I was robbed while jogging in the park",
		event_time: "2024-06-29T12:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T12:20:30.000Z",
		updated_at: "2024-06-29T12:20:30.000Z",
		title: "Park Robbery",
		lat: "23.213456789",
		long: "72.629678901",
	},
	{
		id: "c1b2a3d4-e5f6-4g7h-9i8j-0k1l2m3n4o5p",
		user_id: "667fa17e00143f700eb9",
		type: "theft",
		description: "My camera was stolen from the event venue",
		event_time: "2024-06-29T12:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T12:35:15.000Z",
		updated_at: "2024-06-29T12:35:15.000Z",
		title: "Event Theft",
		lat: "23.206789012",
		long: "72.638901234",
	},
	{
		id: "d3c4b5a6-7f8e-9d0c-1b2a-3e4f5g6h7i8j",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the bridge",
		event_time: "2024-06-29T12:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T12:50:30.000Z",
		updated_at: "2024-06-29T12:50:30.000Z",
		title: "Bridge Vandalism",
		lat: "23.203456789",
		long: "72.641678901",
	},
	{
		id: "f9e8d7c6-b5a4-4e3f-2d1c-0b9a8f7e6d5c",
		user_id: "467fa17e00143f700eba",
		type: "theft",
		description: "My laptop bag was stolen from the coffee shop",
		event_time: "2024-06-29T13:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T13:05:45.000Z",
		updated_at: "2024-06-29T13:05:45.000Z",
		title: "Coffee Shop Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a1b2c3d4-e5f6-6g7h-8i9j-0k1l2m3n4o5",
		user_id: null,
		type: "robbery",
		description: "I was robbed at gunpoint in the alley",
		event_time: "2024-06-29T13:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T13:20:30.000Z",
		updated_at: "2024-06-29T13:20:30.000Z",
		title: "Alley Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "f0e1d2c3-b4a5-5e6f-6d7c-9b8a7f6e5d4c",
		user_id: "667fa17e00143f700ebb",
		type: "assault",
		description: "I was assaulted during the protest",
		event_time: "2024-06-29T13:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T13:35:15.000Z",
		updated_at: "2024-06-29T13:35:15.000Z",
		title: "Protest Assault",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "c7b6a5d4-e3f2-4c1b-9a8d-5e9f8b7a6c5d",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the museum walls",
		event_time: "2024-06-29T13:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T13:50:30.000Z",
		updated_at: "2024-06-29T13:50:30.000Z",
		title: "Museum Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "d9e8c7b6-a5f4-4e3d-2b1c-9a8b-7f6e-5d4c",
		user_id: "467fa17e00143f700ebc",
		type: "theft",
		description: "My wallet was stolen from the metro station",
		event_time: "2024-06-29T14:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T14:05:45.000Z",
		updated_at: "2024-06-29T14:05:45.000Z",
		title: "Metro Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a3b2c1d0-e9f8-8c7b-6a5f-4e3d-2b1c-9a8b",
		user_id: null,
		type: "robbery",
		description: "I was robbed in the parking lot",
		event_time: "2024-06-29T14:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T14:20:30.000Z",
		updated_at: "2024-06-29T14:20:30.000Z",
		title: "Parking Lot Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "f0e1d2c3-b4a5-4e6f-8d7c-9b8a7f6e5d4c",
		user_id: "667fa17e00143f700ebd",
		type: "assault",
		description: "I was attacked while jogging in the park",
		event_time: "2024-06-29T14:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T14:35:15.000Z",
		updated_at: "2024-06-29T14:35:15.000Z",
		title: "Park Attack",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "c7b6a5d4-e3f2-4c1b-9a8d-5e9f8b7a6c5d",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the library walls",
		event_time: "2024-06-29T14:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T14:50:30.000Z",
		updated_at: "2024-06-29T14:50:30.000Z",
		title: "Library Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "d9e8c7b6-a5f4-4e3d-2b1c-9a8b-7f6e-5d4c",
		user_id: "467fa17e00143f700ebe",
		type: "theft",
		description: "My laptop was stolen from the bus station",
		event_time: "2024-06-29T15:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T15:05:45.000Z",
		updated_at: "2024-06-29T15:05:45.000Z",
		title: "Bus Station Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a3b2c1d0-e9f8-8c7b-6a5f-4e3d-2b1c-9a8b",
		user_id: null,
		type: "robbery",
		description: "I was robbed in the alley behind the club",
		event_time: "2024-06-29T15:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T15:20:30.000Z",
		updated_at: "2024-06-29T15:20:30.000Z",
		title: "Club Alley Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "f0e1d2c3-b4a5-4e6f-8d7c-9b8a7f6e5d4c",
		user_id: "667fa17e00143f700ebf",
		type: "assault",
		description: "I was assaulted near the market",
		event_time: "2024-06-29T15:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T15:35:15.000Z",
		updated_at: "2024-06-29T15:35:15.000Z",
		title: "Market Assault",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "c7b6a5d4-e3f2-4c1b-9a8d-5e9f8b7a6c5d",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the university walls",
		event_time: "2024-06-29T15:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T15:50:30.000Z",
		updated_at: "2024-06-29T15:50:30.000Z",
		title: "University Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "d9e8c7b6-a5f4-4e3d-2b1c-9a8b-7f6e-5d4c",
		user_id: "467fa17e00143f700ec0",
		type: "theft",
		description: "My backpack was stolen at the bus stop",
		event_time: "2024-06-29T16:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T16:05:45.000Z",
		updated_at: "2024-06-29T16:05:45.000Z",
		title: "Bus Stop Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a3b2c1d0-e9f8-8c7b-6a5f-4e3d-2b1c-9a8b",
		user_id: null,
		type: "robbery",
		description: "I was robbed in the alley behind the theater",
		event_time: "2024-06-29T16:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T16:20:30.000Z",
		updated_at: "2024-06-29T16:20:30.000Z",
		title: "Theater Alley Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "f0e1d2c3-b4a5-4e6f-8d7c-9b8a7f6e5d4c",
		user_id: "667fa17e00143f700ec1",
		type: "assault",
		description: "I was assaulted near the bus terminal",
		event_time: "2024-06-29T16:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T16:35:15.000Z",
		updated_at: "2024-06-29T16:35:15.000Z",
		title: "Bus Terminal Assault",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "c7b6a5d4-e3f2-4c1b-9a8d-5e9f8b7a6c5d",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the church walls",
		event_time: "2024-06-29T16:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T16:50:30.000Z",
		updated_at: "2024-06-29T16:50:30.000Z",
		title: "Church Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "d9e8c7b6-a5f4-4e3d-2b1c-9a8b-7f6e-5d4c",
		user_id: "467fa17e00143f700ec2",
		type: "theft",
		description: "My laptop was stolen from the train station",
		event_time: "2024-06-29T17:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T17:05:45.000Z",
		updated_at: "2024-06-29T17:05:45.000Z",
		title: "Train Station Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a3b2c1d0-e9f8-8c7b-6a5f-4e3d-2b1c-9a8b",
		user_id: null,
		type: "robbery",
		description: "I was robbed in the alley behind the museum",
		event_time: "2024-06-29T17:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T17:20:30.000Z",
		updated_at: "2024-06-29T17:20:30.000Z",
		title: "Museum Alley Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
	{
		id: "f0e1d2c3-b4a5-4e6f-8d7c-9b8a7f6e5d4c",
		user_id: "667fa17e00143f700ec3",
		type: "assault",
		description: "I was assaulted near the metro entrance",
		event_time: "2024-06-29T17:30:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T17:35:15.000Z",
		updated_at: "2024-06-29T17:35:15.000Z",
		title: "Metro Entrance Assault",
		lat: "23.210123456",
		long: "72.632901234",
	},
	{
		id: "c7b6a5d4-e3f2-4c1b-9a8d-5e9f8b7a6c5d",
		user_id: null,
		type: "vandalism",
		description: "Graffiti on the school walls",
		event_time: "2024-06-29T17:45:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T17:50:30.000Z",
		updated_at: "2024-06-29T17:50:30.000Z",
		title: "School Vandalism",
		lat: "23.204678901",
		long: "72.641678901",
	},
	{
		id: "d9e8c7b6-a5f4-4e3d-2b1c-9a8b-7f6e-5d4c",
		user_id: "467fa17e00143f700ec4",
		type: "theft",
		description: "My phone was stolen at the subway station",
		event_time: "2024-06-29T18:00:00.000Z",
		media_url: null,
		is_anonymous: false,
		created_at: "2024-06-29T18:05:45.000Z",
		updated_at: "2024-06-29T18:05:45.000Z",
		title: "Subway Theft",
		lat: "23.207890123",
		long: "72.639012345",
	},
	{
		id: "a3b2c1d0-e9f8-8c7b-6a5f-4e3d-2b1c-9a8b",
		user_id: null,
		type: "robbery",
		description: "I was robbed in the alley behind the library",
		event_time: "2024-06-29T18:15:00.000Z",
		media_url: null,
		is_anonymous: true,
		created_at: "2024-06-29T18:20:30.000Z",
		updated_at: "2024-06-29T18:20:30.000Z",
		title: "Library Alley Robbery",
		lat: "23.209012345",
		long: "72.635345678",
	},
];

const radius = 0.2;

function calculateDistance(
	lat1: number,
	lon1: number,
	lat2: number,
	lon2: number
) {
	const R = 6371;
	const dLat = (lat2 - lat1) * (Math.PI / 180);
	const dLon = (lon2 - lon1) * (Math.PI / 180);
	const a =
		Math.sin(dLat / 2) * Math.sin(dLat / 2) +
		Math.cos(lat1 * (Math.PI / 180)) *
			Math.cos(lat2 * (Math.PI / 180)) *
			Math.sin(dLon / 2) *
			Math.sin(dLon / 2);
	const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
	const d = R * c;
	return d;
}

// Function to perform spatial clustering
export function spatialCluster(crimeData: any, radius: number) {
	const clusters = [];

	// Iterate through crime reports
	for (let i = 0; i < crimeData.length; i++) {
		const crime = crimeData[i];
		let addedToCluster = false;

		// Check against existing clusters
		for (let j = 0; j < clusters.length; j++) {
			const cluster = clusters[j];

			// Calculate distance to cluster center
			const dist = calculateDistance(
				crime.lat,
				crime.long,
				cluster.center.lat,
				cluster.center.long
			);

			// If within radius, add to cluster
			if (dist <= radius) {
				cluster.crimes.push(crime);
				addedToCluster = true;
				break;
			}
		}

		// If not added to any existing cluster, create a new cluster
		if (!addedToCluster) {
			clusters.push({
				id: clusters.length + 1,
				center: { lat: crime.lat, long: crime.long },
				crimes: [crime],
			});
		}
	}

	return clusters;
}

// Perform spatial clustering
console.log("Data points before clustering ", crimeData.length);
export const crimeClusters = spatialCluster(crimeData, radius);

// Output clusters
console.log("Data points after clustering ", crimeClusters.length);
// console.log(JSON.stringify(crimeClusters, null, 2));
